# 8.29 题解

## T1 千紫万红 game

将边权平分到两点上，那么两人分别选两点时权值会抵消。

直接按边权排序后贪心取最大的即可。

## T2 狭窄回廊 labyrinth

原题相当于求最小深度点分树。

令 $d_i$ 表示 $i$ 在倒数第 $d_i+1$ 次被问到。根据点分树的结论，满足 $d_u=d_v$ 的 $u$ 和 $v$ 的简单路径上必然有一点 $r$ 满足 $d_r>d_u$。

从下往上确定答案。先做深度优先搜索，假设搜到点 $u$。

令 $S_u$ 表示子树内除 $u$ 外的一点 $v$ 到 $u$ 的不含端点的路径上的每一个 $p$ 都满足 $d_p<d_u$ 的点的 $d_v $ 的集合。 

对于 $u$ 的两个儿子 $v_1$ 和 $v_2$， $d_u$ 应大于 $S_{v_1}\cap S_{v_2}$ 的任意元素，否则一定在两个子树内分别选两个 $d$ 相等的点一定不满足条件。

对于 $u$ 的某个儿子 $v$，$d_u$ 显然不能等于 $S_v$ 的任意元素。

直接贪心选最小的 $d_u$ 就是对的。（感受那股劲！）

$d_i$ 不会超过 $\log n$，可以状压维护 $S$。

## T3 崩碎之歌 shattersong

注意到，按照w进行sort，如果$w <= min(M(C_{i}) + Z_{|C_{i}|},M(C_{j}) + Z_{|C_{j}|})$ 且两点不在一个集合内，那么连边。

可以证明一条边如果现在需要连，那么以后也必定需要连。虽然$Z_{i}$并不单调，但是如果之后合并，$M(C_{i})$的值会大于$w$

 同时，某个边如果现在连上了边，那么以后也不可能可以断开。

于是这个构造正确。