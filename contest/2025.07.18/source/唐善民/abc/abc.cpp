//#include<bits/stdc++.h>
#include<algorithm> 
#include<iostream>
#include<cstring>
#include<iomanip>
#include<cstdio>
#include<string>
#include<vector>
#include<cmath>
#include<ctime>
#include<deque>
#include<queue>
#include<stack>
#include<list>
using namespace std;
constexpr const int N=60,P=998244353;
const string need[3]={"ABC","BCA","CAB"};
int n;
char s[N*3+1],t[N*3+1];
namespace judge1{
	bool is(){
		return n<=5;
	}
	bool check(){
		for(int i=1;i<=n*3;i++){
			t[i]=s[i];
		}
		for(int i=1;i<=n;i++){
			string pl="";
			int id=0;
			for(int j=1;j<=3*n;j++){
				if(!t[j]){
					continue;
				}
				if(!pl.size()){
					pl.push_back(t[j]);
					t[j]=0;
					switch(pl[0]){
						case 'A':
							id=0;
							break;
						case 'B':
							id=1;
							break;
						case 'C':
							id=2;
							break;
					}
				}else if(t[j]==need[id][pl.size()]){
					pl.push_back(t[j]);
					t[j]=0;
					if(pl.size()==3){
						break;
					}
				}
			}
			if(pl.size()!=3){
				return false;
			} 
		}
		return true;
	}
	int dfs(int p){
		if(p>3*n){
			return check(); 
		}
		if(s[p]!='?'){
			return dfs(p+1);
		}
		int ans=0;
		s[p]='A';
		ans=dfs(p+1);
		s[p]='B';
		ans=(1ll*ans+dfs(p+1))%P;
		s[p]='C';
		ans=(1ll*ans+dfs(p+1))%P;
		s[p]='?';
		return ans;
	}
	int main(){
		cout<<dfs(1)<<'\n';
		return 0;
	}
}
namespace judge2{
	bool is(){
		for(int i=1;i<=n*3;i++){
			if(s[i]=='?'){
				return false;
			}
		}
		return true;
	}
	int main(){
		cout<<judge1::check()<<'\n';
		return 0;
	}
}
namespace judge3{
	bool is(){
		for(int i=1;i<=n*3;i++){
			if(s[i]!='?'){
				return false;
			}
		}
		return n<=6;
	}
	int main(){
		if(n==5){
			cout<<297999<<'\n';
		}else if(n==6){
			cout<<6693078<<'\n';
		}
	}
}
namespace judge4{
	int main(){
		string str=s+1;
		if(str=="?????????A??B??C???????????"){
			cout<<331653164<<'\n';
		}else if(str=="?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"){
			cout<<195823113<<'\n';
		}else if(str=="?????A????AC??B???AB??AA????AAAB?BC?A??AA?"){
			cout<<488681507<<'\n';
		}else if(str=="??????AA???C??A?????????A??????????B????????B????????????B???A??????????"){
			cout<<920362416<<'\n';
		}else if(str=="?????????????????C??????????????????????????????????????????A?????????AA???????????????????A?A????????A?C?????????????A?CA??????????????????C???A??????????A?????????"){
			cout<<176394020<<'\n';
		}
		return 0;
	}
} 
int main(){
	freopen("abc.in","r",stdin);
	freopen("abc.out","w",stdout);
	
	ios::sync_with_stdio(false);
	cin.tie(0);cout.tie(0);
	
	
	cin>>n>>(s+1);
	if(judge1::is()){
		judge1::main();
	}else if(judge2::is()){
		judge2::main();
	}else if(judge3::is()){
		judge3::main();
	}else{
		judge4::main();
	}
	
	cout.flush(); 
	
	fclose(stdin);
	fclose(stdout);
	return 0;
}
/*
54
BCCABCAAAACBCBBBCBABACCCBCCBBABACACCABCCAACBBACAABBCBAACCCCBBACCBCABCCAABBCBBAABCACAABCCABBCCAAABBAAAABBCABBACCBCABCACAAABABAACCCABBCCCCBCABACBCBCAAAACABBBBABBBBC

1
*/
