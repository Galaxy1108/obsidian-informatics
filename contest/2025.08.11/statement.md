# 咕嘎模拟赛

（请选手务必仔细阅读本页内容）

## 一、题目概况

| 中文题目名称 | 基因编辑 | 长野原龙势流星群 | 京都观光 | 求和避免 |
| :---: | :---: | :---: | :---: | :---: |
| 英文题目名称 | gene | tree | kyoto | sum |
| 可执行文件名 | gene | tree | kyoto | sum |
| 输入文件名 | gene.in | tree.in | kyoto.in | sum.in |
| 输出文件名 | gene.out | tree.out | kyoto.out | sum.out |
| 提交文件名 | gene.cpp | tree.cpp | kyoto.cpp | sum.cpp |
| 每个测试点时限 | 1秒 | 1秒 | 2秒 | 4秒 |
| 测试点数目 | 20 | 20 | 20 | 20 |
| 每个测试点分值 | 5 | 5 | 5 | 5 |
| 内存限制 | 512MB | 512MB | 1024MB | 1024MB |
| 题目类型 | 传统题 | 传统题 | 传统题 | 传统题 |

 

## 二、编译命令

| 题目名称 | gene | tree | kyoto | sum |
| :---: | :---: | :---: | :---: | :---: |
| 对于C++语言 | -o gene gene.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 | -o tree tree.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 | -o kyoto kyoto.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 | -o sum sum.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 |

 

## 三、注意事项 

1. 文件夹名、文件名(程序名和输入输出文件名)必须使用英文小写。
2. C/C++中函数main()的返回值类型必须是int,程序正常结束时的返回值必须是0。
3. 统一评测时采用的机器配置为：windows下lemon评测。
4. 请尽力优化，会收获更多的部分得分。
5. **AK 了不要大声喧哗，没AK也不要**。

# 基因编辑(gene)

## 题目描述

人类目前已经研究出了多种基因编辑技术，其中最传统的一种技术需要用到“限制性核酸内切酶”（简称限制酶）。这种酶能够识别特定的核苷酸序列，并在指定的位点上切割连接相邻核苷酸的磷酸二酯键，产生被称为“末端”的序列切口。只有相匹配的末端才能用 DNA 连接酶进行连接。

假设现在要用基因片段 $A$ 去替换某一载体 $V$ 上的基因片段 $B$。在使用限制酶的编辑技术中，通常需要进行以下操作：

1. 在基因 $A$ 的两端各选择一种限制酶识别位点。这两处识别位点在基因 $B$ 的两端也应当相应存在。
2. 用所选择的识别位点对应的限制酶对基因 $A$ 进行处理，使得其两端产生相应的末端。将处理后的基因 $A$ 提纯。
3. 用同样的限制酶切断载体 $V$ 上的识别位点，使得基因 $B$ 与载体 $V$ 断开。纯化出去除了基因 $B$ 的载体 $V'$。
4. 将载体 $V'$ 与基因 $A$ 混合，并在 DNA 连接酶的帮助下将断开的磷酸二酯键重新接上。

值得一提的是，如果两处识别位点断开后产生了相同的末端，那么在第 4 步中载体 $V'$ 有可能单独连接起来，产生了不包含基因 $A$ 或 $B$ 的载体；也有可能基因 $A$ 反向接入 $V'$，同样产生错误的载体。因此，在实际运用中，通常选取产生不同末端的限制酶对基因 $A$ 和载体 $V$ 进行处理。

公元 3032 年，人类发现了一种掌握了基因编辑技术的外星文明 HD1048576d。当然，这种基因编辑的技术仅限于居住在 HD1048576d 这颗行星上的外星生物的基因。我们人类掌握的基因编辑技术可识别的最小单位是 DNA 序列上的单个碱基，而外星文明的基因编辑技术可识别的最小单位是其基因序列上的单个 noicleobase。出于方便起见，我们可以将单个 noicleobase 用从 $1$ 开始的正整数表示，那么一段外星生命的基因序列就可以被表示成相应的正整数序列。

对于一段长度为 $n$ 的外星生命的基因序列（不妨记其正整数表示为 $s_1, s_2, \cdots, s_n$），外星文明 HD1048576d 的基因编辑过程如下：

1. 选择一段要编辑的区域 $[l, r]$，即原位替换原序列中 $s_l, s_{l+1}, \cdots, s_r$ 这部分子序列；
2. 挑选一对跨过待替换区域的下标 $(i, j)$（即 $1\le i<l$ 且 $r<j\le n$），批量生产出 $s_i, \cdots, s_j$ 这段子序列在编辑后对应的新序列 $s_i, \cdots, s_{l-1}, t_1, \cdots, t_k, s_{r+1}, \cdots, s_j$；
3. 通过对应的特异性识别工具，将 $s_i, \cdots, s_j$ 这段子序列从原序列中断开，并将 $s_i, \cdots, s_{l-1}, t_1, \cdots, t_k, s_{r+1}, \cdots, s_j$ 接到序列中，即可得到目标基因序列。

需要注意的是，在步骤 2 中，挑选的这对下标必须对应唯一的 noicleobase 组合。也就是说，能够满足 $s_{i'}=s_i, s_{j'} = s_j$ 且 $i<j$ 的有序对 $\left(i', j'\right)$ 必须是唯一的（即为 $(i, j)$），否则特异性识别工具可能切割下其它区段的基因序列；另外，$s_i\ne s_j$，否则特异性识别工具可能只切割下单个 noicleobase。

另外，由于替换时需要生产新的基因序列，而生产这样的序列需要不小的开销，所以外星文明希望能够最小化需要生产的基因序列长度。显然，最小化这一长度等价于最小化被切割下来的基因子序列的长度，所以实践中一般是通过最小化被切割下来的基因子序列长度来计算最优解的。

现在，他们想考考人类文明的智力水平，于是你被他们从众多高中生中挑选出来解决这一问题。

## 输入格式

输入的第一行包含三个正整数 $n, l, r$，表示待编辑的基因序列的长度，需要编辑的区域的左端点，和需要编辑的区域的右端点。保证 $3\le n\le 10^6$ 且 $1<l\le r < n$。

输入的第二行包含 $n$ 个正整数 $s_1, \cdots, s_n$，表示用正整数表示的待编辑的基因序列。保证每个 noicleobase 的编号 $s_i$ 都在 $[1, 10^6]$ 中。

## 输出格式

如果存在满足外星文明的基因编辑技术限制的基因序列切割方案，则输出一个正整数，表示输出所有方案中，被切割下来的基因子序列的最小值。否则，输出 `-1`，表示不存在满足限制的切割方案。


## 样例

#### 样例1输入

```
10 4 6
2 1 4 7 4 8 3 6 4 8
```

#### 样例1输出

```
6
```

#### 样例1解释

最优方案为切割 `1 4 7 4 8 3`。可以证明，没有比这更优秀的满足技术限制的切割方案。

一种比该方案切割长度更短的方案是 `4 7 4 8 3`，但是在这种方案中特异性识别工具可能会断开 `4 8 3`，从而导致产生的目标基因序列出现意外的突变，因此这种切割方案不满足技术限制。

## 数据范围

对于所有数据，满足：$3\le n \le 10^6$，$\forall 1\le i\le n, 1\le s_i\le 10^6$，且 $1<l\le r<n$。

| 测试点编号 | $n\le $ | $s_i\le $ | 特殊性质 |
| :---: | :---: | :---: | :---: |
| $1\sim 4$ | $10^3$ | $10^3$ | 无 |
| $5\sim 8$ | $10^3$ | $10^6$ | 无 |
| $9\sim 12$ | $10^6$ | $10^3$ | 无 |
| $13\sim 16$ | $10^6$ | $10^6$ | $s_1, \cdots, s_{l - 1}$ 各不相同，且 $s_{r + 1}, \cdots, s_n$ 各不相同 |
| $17\sim 20$ | $10^6$ | $10^6$ | 无 |

# 长野原龙势流星群(tree)

## 题目描述

关于题目名称，原题如此。

Naganohara Yoimiya 给了你一棵 $n$ 个节点的有根树，$1$ 号节点是根节点，每个点有点权 $w_i$。

你需要对每个点 $u$ 找到一个以 $u$ 为根的非空连通块，并最大化这个连通块内所有点的点权的平均值。

对每个点 $u$ 输出这个最大的平均值。

## 输入格式

第一行一个正整数 $n$。

接下来一行 $n−1$ 个正整数 $p_2,p_3,\dots,p_n$，$pi$ 表示 $i$ 的父节点的编号，保证 $pi<i$。

接下来一行 $n$ 个正整数 $w_1,w_2,\dots,w_n$。

## 输出格式

输出 $n$ 行，第 $i$ 行输出一个实数表示以节点 $i$ 为根的连通块内点权平均值的最大值。

如果你的答案和标准答案的相对误差或绝对误差不超过 $10^−6$ 则视为正确。

## 样例

#### 样例1输入

```
6
1 2 2 1 4
3 1 5 6 6 7
```

#### 样例1输出

```
4.6666666667
4.7500000000
5.0000000000
6.5000000000
6.0000000000
7.0000000000
```

## 数据范围

对于全部数据，满足 $1\le n\le 5\times 10^5$，$1\le w_i\le 10^9$。

|    测试点编号    |                     约束                     |
| :---------: | :----------------------------------------: |
|  $1\sim 6$  |                $n\le 10^3$                 |
|  $7\sim 9$  | $p_i=\left\lfloor\frac{i}{2}\right\rfloor$ |
| $10\sim 14$ |          $1\le n\le 5\times 10^4$          |
| $15\sim 17$ |          $1\le n\le 2\times 10^5$          |
| $16\sim 20$ |                   无特殊限制                    |

# 京都观光(kyoto)

## 题目描述

京都是世界级的观光圣地，它也被称为网格城市。你来到了京都观光，并且你计划步行游览一个著名的景点。本题中，我们考虑如下的简化问题。

在城市中，有 $H$ 条东西方向的街道和 $W$ 条南北方向的街道，因此城市是一个 $(H-1)\times(W-1)$ 的网格。从北数第 $i$ 条街道和从西数第 $j$ 条街道的交叉点记作路口 $(i,j)$。

不同的街道可能有不同的材质、宽度和拥挤程度，因此你的步行速度有可能不同。对于每条街道，你的步行速度如下：

- 如果你在从北数第 $i$ 条街道上行走单位长度，需要 $A_i$ 秒。即从路口 $(i,c)~\left(i\in[1,H],c\in[1,W)\right)$ 走到路口 $(i,c+1)$ 需要 $A_i$ 秒。
- 如果你在从西数第 $j$ 条街道上行走单位长度，需要 $B_j$ 秒。即从路口 $(c,j)~\left(c\in[1,H),j\in[1,W]\right)$ 走到路口 $(c+1,j)$ 需要 $B_j$ 秒。

你现在在路口 $(1,1)$，你想前往 $(H,W)$，你必须沿着街道行走，并且你不希望走远路，即你不会向北或向西走。

你希望尽早到达目的地，请你求出，在给定的条件下，从路口 $(1,1)$ 前往路口 $(H,W)$ 所需的最少时间。

## 输入格式

第一行两个整数 $H,W$ 表示街道条数。

第二行 $H$ 个整数，第 $i$ 个整数 $A_i$ 表示从北数第 $i$ 条东西方向街道的步行速度。

第三行 $W$ 个整数，第 $i$ 个整数 $B_i$ 表示从西数第 $i$ 条南北方向街道的步行速度。

## 输出格式

一行一个整数，表示所需的最小步行时间。

## 样例

#### 样例1输入

```
2 2
1 3
2 5
```

#### 样例1输出

```
5
```

#### 样例1解释

有两条从 $(1,1)$ 到 $(2,2)$ 的路线：

1. $(1,1)\rightarrow(1,2)\rightarrow(2,2)$，所需时间为 $1+5=6$ 秒。
2. $(1,1)\rightarrow(2,1)\rightarrow(2,2)$，所需时间为 $2+3=5$ 秒。

因此最少花费时间为 $5$ 秒。

#### 样例2输入

```
5 5
7 1 5 2 8
7 2 4 1 6
```

#### 样例2输出

```
20
```

#### 样例2解释

最优路线如下图：

![样例解释](https://cdn.luogu.com.cn/upload/image_hosting/mqsalajm.png)

#### 样例3输入

```
4 6
454863204 543362989 866044086 813602010
71574269 17945210 688720933 392135202 38174709 168241720
```

#### 样例3输出

```
2737473954
```

## 数据范围

对于所有测试数据：$2\le H,W\le 10^6$，$1\le A_i,B_i\le 10^9$。

每个测试点的具体限制见下表：

| 测试点编号 | 特殊性质 |
| :---: | :---: |
| $1\sim 6$ | $H,W\le 10^3$ |
| $7\sim 12$ | $A_i,B_i\le 10^3$ |
| $13\sim 16$ | $H,W\le 10^5$ |
| $17\sim 20$ | 无特殊限制 |

# 求和避免(sum)

## 题目描述

给定一个正整数 $S$，称一个正整数集合 $A$ 是好的，当且仅当它满足以下条件：

* $A$ 中元素在 $[1,S)$ 之间。
* 不能用 $A$ 中元素多次相加得到 $S$。

考虑所有好的集合中元素数量最大且所有元素的最小字典序最小的集合 $A$，多次询问，求集合 $A$ 从小到大排序后的第 $K$ 项。

## 输入格式。

本题有多组数据。

第一行输入一个数 $T$ 表示测试点数量。对于每一组测试点：

仅一行两个数 $S$ 和 $K$。

## 输出格式

输出共 $T$ 行，第 $i$ 行有一个整数，表示第 $i$ 组询问答案。如果集合的 $A$ 的大小小于 $K$，则输出 $-1$。

## 样例

#### 样例1输入

```
13
3 1
3 2
7 1
7 2
7 3
7 4
10 1
10 2
10 3
10 4
10 5
2022 507
1000000000000000000 999999999999999999
```

#### 样例1输出

```
2
-1
2
4
6
-1
3
6
8
9
-1
1351
-1
```

#### 样例1解释

对于 $S=10$ 而言，$A=\{3,6,8,9\}$ 为题目所求的集合。

$A=\{3,4,8,9\}$ 不满足条件因为有 $3+3+4=10=S$。

$A=\{6,7,8,9\}$ 不满足条件因为其不是最小字典序最小的集合。

## 数据范围

对于所有测试点：$1\le T\le 1000$，$3\le K\le S\le 10^{18}$。

|    测试点编号    |         特殊性质         |
| :---------: | :------------------: |
|  $1\sim 4$  |     $S\bmod 2=1$     |
|  $5\sim 8$  |  $S\le 10^6$，$T=1$   |
| $9\sim 12$  | $S\le 10^{12}$，$T=1$ |
| $13\sim 20$ |        无特殊限制         |
