# 数学模拟赛

（请选手务必仔细阅读本页内容）

## 一、题目概况

|  中文题目名称  | 完全平方数 | 最大公约数 |     组合数      | 最小公倍数 |
| :------------: | :--------: | :--------: | :-------------: | :--------: |
|  英文题目名称  |   square   |    gcd     |   combination   |    lcm     |
|  可执行文件名  |   square   |    gcd     |   combination   |    lcm     |
|   输入文件名   | square.in  |   gcd.in   | combination.in  |   lcm.in   |
|   输出文件名   | square.out |  gcd.out   | combination.out |  lcm.out   |
|   提交文件名   | square.cpp |  gcd.cpp   | combination.cpp |  lcm.cpp   |
| 每个测试点时限 |    1秒     |    2秒     |       1秒       |    2秒     |
|   测试点数目   |     20     |     20     |       20        |     20     |
| 每个测试点分值 |     5      |     5      |        5        |     5      |
|    内存限制    |   512MB    |   512MB    |      512MB      |   512MB    |
|    题目类型    |   传统题   |   传统题   |     传统题      |   传统题   |

 

## 二、编译命令

|  题目名称   |                            square                            |                           gcd                            |                         combination                          |                           lcm                            |
| :---------: | :----------------------------------------------------------: | :------------------------------------------------------: | :----------------------------------------------------------: | :------------------------------------------------------: |
| 对于C++语言 | -o square square.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 | -o gcd gcd.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 | -o combination combination.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 | -o lcm lcm.cpp -lm -std=c++14 -O2 -Wl,--stack=2147483647 |

 

## 三、注意事项 

1. 文件夹名、文件名(程序名和输入输出文件名)必须使用英文小写。
2. C/C++中函数main()的返回值类型必须是int,程序正常结束时的返回值必须是0。
3. 统一评测时采用的机器配置为：windows下lemon评测。
4. 请尽力优化，会收获更多的部分得分。



# 完全平方数(square)

## 题目描述

给定 $n$ 个数 $a_1,a_2\dots a_n$，问有多少种从中选择至少一个数的方式，使得这些数的乘积是完全平方数。答案对 $10^9+7$ 取模。

## 输入格式

第一行输入一个数 $n$。

第二行输入 $n$ 个数 $a_1,a_2\dots a_n$。

## 输出格式

输出一个数，表示答案。

## 样例

#### 样例1输入

```
4
1 1 1 1
```

#### 样例1输出

```
15
```

#### 样例2输入

```
5
1 2 4 5 8
```

#### 样例2输出

```
7
```

## 数据范围

对于所有数据，满足：$1 \leq n \leq 10^5$，$1 \leq a_i \leq 70$。

| 测试点编号  |       特殊性质        |
| :---------: | :-------------------: |
|  $1\sim 4$  |       $n\le 20$       |
|  $5\sim 8$  | $a_i$ 均为 $2$ 的幂次 |
| $9\sim 10$  |     $a_i$ 为质数      |
| $11\sim 20$ |      无特殊约束       |

# 最大公约数(gcd)

## 题目描述

$n$ 次询问，每一次求有多少对数对 $(x,y)$，满足 $a\le x\le b$，$c\le y\le d$，$\gcd(x,y)=k$。

## 输入格式

第一行输入一个数 $n$，表示询问组数。

接下来的 $n$ 行，每行五个数 $a,b,c,d,k$，表示一组询问。

## 输出格式

共 $n$ 行，每行一个数表示答案。

## 样例

#### 样例1输入

```
2
2 5 1 5 1
1 5 1 5 2
```

#### 样例1输出

```
14
3
```

## 数据范围

对于所有数据，满足 $1\le n\le 10^4$，$k\le 10^6$，$1\le a\le b\le 10^6$，$1\le c\le d\le 10^6$。

| 测试点编号  |     约束     |
| :---------: | :----------: |
|  $1\sim 5$  | $b,d\le 100$ |
|  $6\sim 8$  |    $k=1$     |
| $9\sim 12$  |   $a=c=1$    |
| $13\sim 20$ |  无额外约束  |

# 组合数(combination)

## 题目描述

给定 $n,x,p$，以及一个 $m$ 次多项式 $f(x)=a_0+a_1x+a_2x^2+\dots a_mx^m$，求：

$$\left(\sum\limits_{k=0}^nf(k)x^k\dbinom{n}{k}\right)\bmod p$$

## 输入格式

第一行，输入四个非负整数 $n,x,p,m$。

第二行输入 $m+1$ 个数，分别代表 $a_0,a_1\dots a_m$。

## 输出格式

仅一行表示答案。

## 样例

#### 样例1输入

```
5 1 10007 2
0 0 1
```

#### 样例1输出

```
240
```

#### 样例1解释

$f(0) = 0，f(1) = 1，f(2) = 4，f(3) = 9，f(4) = 16，f(5) = 25$。

$x = 1$，故 $x^k$ 恒为 $1$，乘积中的该项可以忽略。

$\binom 5 0 = 1, \binom 5 1 = 5, \binom 5 2 = 10, \binom 5 3 = 10, \binom 5 4 = 5, \binom 5 5 = 1$。

#### 样例2输入

```
996 233 998244353 5
5 4 13 16 20 15
```

#### 样例2输出

```
869469289
```

## 数据范围

对于所有测试数据：$1\le n, x, p \le 10^9, 0\le a_i\le 10^9, 0\le m \le \min(n,1000)$。

每个测试点的具体限制见下表：

| 测试点编号  | $n\le $ | $m\le $ | 其他特殊限制 |
| :---------: | :-----: | :-----: | :----------: |
|  $1\sim 3$  | $1000$  | $1000$  |              |
|  $4\sim 6$  | $10^5$  |   $0$   |  $p$ 是质数  |
|  $7\sim 8$  | $10^9$  |   $0$   |              |
| $9\sim 12$  | $10^9$  |   $5$   |              |
| $13\sim 16$ | $10^9$  | $1000$  |    $x=1$     |
| $17\sim 20$ | $10^9$  | $1000$  |              |

# 最小公倍数 (lcm)

## 题目描述

多组询问，输入 $N,K$，求解：

$$\prod\limits_{i_1=1}^N\prod\limits_{i_2=1}^N\dots\prod\limits_{i_k=1}^N\operatorname{lcm}(i_1,i_2,\dots i_k)$$

答案对 $998244353$ 取模。

## 输入格式

第一行一个数 $T$，表示数据组数。

接下来的 $T$ 行，每行两个数 $N,K$ 表示一组询问。

## 输出格式

输出 $T$ 行，表示答案。

## 样例

#### 样例1输入

```
2
2 2
3 2
```

#### 样例1输出

```
8
7776
```

## 数据范围

对于所有数据，$1\le T\le 10^3$，$1\le N\le 10^6$，$1\le K\le 10^{100}$。

| 测试点编号  |            特殊性质            |
| :---------: | :----------------------------: |
|  $1\sim 3$  | $N\le 10$，$K\le 5$，$T\le 10$ |
|  $4\sim 8$  |            $K\le 2$            |
| $9\sim 13$  |            $K\le 3$            |
| $14\sim 16$ |     $K\le 100$，$T\le 10$      |
| $17\sim 20$ |           无特殊限制           |